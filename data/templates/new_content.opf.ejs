<?xml version="1.0" encoding="utf-8"?>
<package xmlns="http://www.idpf.org/2007/opf" unique-identifier="pub-id" version="3.0">
    <metadata xmlns:dc="http://purl.org/dc/elements/1.1/">
        <dc:identifier id="pub-id">
            <%= id %>
        </dc:identifier>
        <dc:language>
            <%= lang || "en" %>
        </dc:language>
        <dc:title>
            <%= title %>
        </dc:title>
        <meta property="dcterms:modified">
        <%= (new Date()).toISOString().split(".")[0]+ "Z" %>
            </meta>
            <meta name="cover" content="cover" />
            <meta name="primary-writing-mode" content="horizontal-rl" />
    </metadata>

    <manifest>
        <% if(locals.cover) { %><item id="cover" href="cover.<%= _coverExtension %>" media-type="<%= _coverMediaType %>" /><% } %>
        <% fonts.forEach(function(font, index){ %>
        <item id="font_<%= index%>" href="fonts/<%= font %>" media-type="application/vnd.ms-opentype" /><% }) %>

        <item id="toc" properties="nav" href="toc.xhtml" media-type="application/xhtml+xml" />
        <% content.forEach(function(content, index){ %>
        <item id="<%= `content-${index+1}` %>" href="<%= content.href %>" media-type="application/xhtml+xml" /><% }) %>

        <item id="ncx" href="toc.ncx" media-type="application/x-dtbncx+xml" />
        <item id="css" href="style.css" media-type="text/css" />
    </manifest>

    <spine toc="ncx" page-progression-direction="rtl">
        <itemref idref="toc" />
        <% content.forEach(function(content, index){ %>
                <itemref idref="<%= `content-${index+1}` %>"/>
        <% }) %>
    </spine>
    <!-- <guide>
        <reference type="text" title="Table of Content" href="toc.xhtml"/>
    </guide> -->
</package>
